---
- name: Add nginx PPA
  apt_repository: repo=ppa:nginx/stable
  tags: nginx

- name: Install nginx 
  apt: name=nginx state=installed
  when: nginx_naxsi == false
  tags: nginx

- name: Install nginx_naxsi 
  apt: name=nginx_naxsi state=installed
  when: nginx_naxsi == true
  tags: nginx

- name: Disable default site
  file: path=/etc/nginx/sites-enabled/default state=absent
  notify: restart nginx
  tags: php

- name: Write nginx.conf 
  template: src=nginx.conf.j2 dest='/etc/nginx/nginx.conf' backup=yes
  notify: restart nginx
  tags: nginx

- name: Start nginx 
  service: name=nginx state=started
  notify: allow nginx
  tags: nginx